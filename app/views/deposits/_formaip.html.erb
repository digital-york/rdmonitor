<%= form_for @deposit, url: deposit_path do |f| %>
    <% if @deposit.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@deposit.errors.count, "error") %> prohibited this deposit from being saved:</h2>

          <ul>
            <% @deposit.errors.full_messages.each do |message| %>
                <li><%= message %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

    <div class="field">
      <%= f.label 'README' %><br>
      <p>Please provide any information that would help others use the data, for example deployment instructions or required software.</p>
      <%= f.text_area :readme %>
    </div>

    <div class="field">
      <%= f.label "Select local files to deposit" %>&nbsp;
      <%= f.file_field :file, id: "real_file_btn", style: "display: none", multiple: true %><br>
      <button type="button" class="btn btn-large btn-success" id="file_upload_btn">Choose Files</button>
      <span id="file_upload_status">No file chosen</span>
    </div>

    <div class="field">
      <%= f.label "Select a local directory to deposit" %>&nbsp;
      <%= f.file_field :file, id: "real_dir_btn", style: "display: none", multiple: true, directory: true, webkitdirectory: true, mozdirectory: true %><br>
      <button type="button" class="btn btn-large btn-success" id="dir_upload_btn">Choose Directory</button>
      <span id="dir_upload_status">No directory chosen</span>
    </div>

    <div class="field">
      <%= f.label "Select Google Drive files to deposit (browse everything)" %>&nbsp;<br>
      <button type="button" data-toggle="browse-everything" data-route="<%=browse_everything_engine.root_path%>"
              data-target="#new_deposit" id="google_drive_btn" class="btn btn-large btn-success">Choose Files</button>
      <span id="google_drive_status">No file chosen</span>
    </div>

    <div class="field">
      <%= f.label "Select Google Drive files to deposit (local code)" %>&nbsp;<br>
      <button type="button" class="btn btn-large btn-success" id="google-drive-btn2">Choose Files</button>
      <span id="google_drive_status2">No file chosen</span>
    </div>

    <div id="googleDriveDialog" title="Select files from Google Drive">
      <p>Loading Google Drive - please wait...</p>
    </div>

    <script>
    $( function() {
      dialog2 = $( "#googleDriveDialog" ).dialog({
        autoOpen: false,
        resizable: true,
        height: 500,
        width: 600,
        modal: true,
        buttons: {
          "OK": function() {
            $( this ).dialog( "close" );
          },
          Cancel: function() {
            $( this ).dialog( "close" );
          }
        }
      });
      $( "#google-drive-btn2" ).button().on( "click", function() {
        dialog2.dialog( "open" );
        dialog2.load('/googledrive', function() {
          // code here for on_success
        });
      });
    } );
    </script>

    <div class="actions">
      <%= f.submit 'Deposit' %>
    </div>

<% end %>
